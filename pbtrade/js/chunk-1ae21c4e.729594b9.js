(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ae21c4e"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f"),a("00b4");var n=a("6b75");function o(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},1393:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("topNav",{attrs:{title:"归还"}}),a("div",{staticClass:"topButton",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"handleBtnBox"},[a("el-button",{attrs:{disabled:0==t.canSubmitData.length},on:{click:t.LeftQty1Seve}},[t._v("自动填充归还数量（"+t._s(t.canSubmitData.length)+"）")]),a("el-upload",{ref:"upload",staticClass:"uploadbtn ml20",attrs:{"on-change":t.importExcel,"auto-upload":!1,"show-file-list":!1,action:""}},[a("el-button",[t._v("导入文件")])],1),0===t.tableData.length?a("a",{attrs:{href:"https://statics.citics.com/xinweb/%E5%BD%92%E8%BF%98%E6%B8%85%E5%8D%95%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF.xlsx"}},[a("el-button",{staticClass:"ml20"},[t._v(" 导出文件/模板 ")])],1):a("el-button",{staticClass:"ml20",attrs:{loading:t.exportLoading},on:{click:t.exportData}},[t._v(" 导出文件/模板 ")])],1)]),a("div",{staticClass:"bgfff",staticStyle:{"padding-bottom":"30px"}},[a("el-table",{staticClass:"pubTable",staticStyle:{width:"100%"},attrs:{data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",prop:"number",align:"center",label:"序号",width:"80",index:1}}),a("el-table-column",{attrs:{prop:"status",align:"center",label:"状态",width:"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),a("el-table-column",{attrs:{prop:"LeftQty1",align:"center",label:"归还数量",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("EditableCell",{attrs:{text:e.row.LeftQty1+"",record:e.row,dataName:"guihuan",noEdit:t.noEdit(e.row.status)},on:{change:function(a){return t.onCellChange(e.row,"LeftQty1",a)}}})]}}])}),a("el-table-column",{attrs:{prop:"LeftQty2",align:"center",label:"未还数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.LeftQty2||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"PreRate",align:"center",label:"提前归还费率",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.decidEmpty(e.row.PreRate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"PostRate",align:"center",label:"违约金率"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.decidEmpty(e.row.PostRate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"EndDate",align:"center",label:"到期日期",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.EndDate||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"CompactNo",align:"center",label:"合约编号",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.CompactNo||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"StockCode",align:"center",label:"证券代码"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.StockCode||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"StockName",align:"center",label:"证券名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.StockName||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"AppType",align:"center",label:"约定类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.dictionary.AppType[e.row.AppType]||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"BusiCode",align:"center",label:"约定模式"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.dictionary.BusiCodeDic[e.row.BusiCode]||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"action",align:"center",label:"操作",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"tableHandle"},[a("a",{staticClass:"colorBlue",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.deleteSingle(e.row)}}},[t._v("删除")]),a("a",{staticClass:"colorRed",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.showMingxi(e.row)}}},[t._v("明细")])])]}}])})],1),a("el-table",{staticClass:"pubTable",staticStyle:{width:"100%",display:"none"},attrs:{data:t.tableData,id:"tableExport"}},[a("el-table-column",{attrs:{type:"index",prop:"number",align:"center",label:"序号",width:"80",index:1}}),a("el-table-column",{attrs:{prop:"status",align:"center",label:"状态",width:"120"}}),a("el-table-column",{attrs:{prop:"LeftQty1",align:"center",label:"归还数量",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.LeftQty1||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"LeftQty2",align:"center",label:"未还数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.LeftQty2||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"PreRate",align:"center",label:"提前归还费率",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.decidEmpty(e.row.PreRate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"PostRate",align:"center",label:"违约金率"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.decidEmpty(e.row.PostRate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"EndDate",align:"center",label:"到期日期",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.EndDate||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"CompactNo",align:"center",label:"合约编号",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.CompactNo||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"StockCode",align:"center",label:"证券代码"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.StockCode||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"StockName",align:"center",label:"证券名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.StockName||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"AppType",align:"center",label:"约定类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.dictionary.AppType[e.row.AppType]||"--")+" ")]}}])}),a("el-table-column",{attrs:{prop:"BusiCode",align:"center",label:"约定模式"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.dictionary.BusiCodeDic[e.row.BusiCode]||"--")+" ")]}}])})],1),a("div",{staticClass:"submitBox"},[a("el-button",{attrs:{disabled:0==t.multipleSelection.length},on:{click:t.deleteData}},[t._v("删除（"+t._s(t.multipleSelection.length)+"）")]),a("el-button",{staticClass:"ml20 submitbtn",attrs:{disabled:0==t.canSubmitData.length},on:{click:t.submitZq}},[t._v("提交（"+t._s(t.canSubmitData.length)+"）")])],1)],1),a("pubMingxi",{ref:"pubMingxi",attrs:{detailData:t.detailData}}),a("zqResult",{ref:"resultModel",attrs:{title:"归还",failData:t.failData,successData:t.successData}}),a("uploadLoad",{ref:"uploadLoad"}),a("exportConfirm",{ref:"exportConfirm",on:{confirm:t.exportConfirm}})],1)},o=[],r=a("1da1"),i=a("2909"),l=a("5530"),c=(a("96cf"),a("4de4"),a("d3b7"),a("159b"),a("e9c4"),a("7db0"),a("a434"),a("3ca3"),a("ddb0"),a("6a6e")),s=a("29c1"),u=a("0680"),f=a("ca00"),d=a("1540"),p=a("1146"),b=a.n(p),h=a("9928"),m=a("593b"),y=a("340e"),g=a("1414"),v=a("1ba4"),S=a("2f62"),D={components:{pubMingxi:s["a"],topNav:c["a"],EditableCell:h["a"],zqResult:m["a"],uploadLoad:y["a"],exportConfirm:g["a"]},data:function(){return{dictionary:u["a"],datetype:"",multipleSelection:[],zhandate:"",NewDatd:"",tableData:[],editData:[],failData:[],successData:[],detailData:{},importData:[],newImportData:[],resultTip:"",importSuccessData:[],importFailData:[],decidEmpty:f["a"].decidEmpty,exportLoading:!1}},computed:Object(l["a"])(Object(l["a"])({},Object(S["c"])(["fundAccount"])),{},{canSubmitData:function(){return this.multipleSelection.filter((function(t){return"未提交"===t.status}))}}),created:function(){var t=JSON.parse(localStorage.getItem("selectData"));t&&0!==t.length&&(t.forEach((function(t){t.LeftQty1="",t.LeftQty2=t.LeftQty-t.ExQty,t.status="未提交"})),this.tableData=t.filter((function(t){return t.ExQty<t.LeftQty})))},mounted:function(){},methods:{noEdit:d["a"].noEdit,handleSelectionChange:function(t){this.multipleSelection=t},showMingxi:function(t){this.detailData={"归还数量":t.LeftQty1||"--","未还数量":t.LeftQty2,"提前归还费率":f["a"].percent2(t.PreRate),"违约金率":f["a"].percent2(t.PostRate),"到期日期":t.EndDate||"--","合约编号":t.CompactNo||"--","证券代码":t.StockCode||"--","证券名称":t.StockName||"--","约定类型":u["a"].AppType[t.AppType],"约定模式":u["a"].BusiCodeDic[t.BusiCode]},this.$refs.pubMingxi.showModel()},submitZq:function(){this.successData=[],this.failData=[],this.isCansub=!0;var t=this.canSubmitData,e=t.every((function(t,e,a){return t.LeftQty1&&t.LeftQty1>0}));e?(this.$refs.uploadLoad.showModel(),this.submitFun(t,0,t.length)):this.$message("请填写要提交数据的归还数量")},submitFun:function(t,e,a){var n=this;if(!(e>a-1)){var o=t[e],r={RouteID:"W",OpStation:"127.0.0.1",OperatorID:this.fundAccount,AppNo:o.CompactNo,BasketProp:o.BasketProp,FundAccount:this.fundAccount,Qty:o.LeftQty1};Object(v["a"])(r,106).then((function(t){o.resultMsg="归还成功",o.status="提交成功",n.successData.push(o)})).catch((function(t){var e=t.errorMessage||t.message;-1!=e.indexOf("timeout")?o.status="提交失败（接口调用超时)":o.status="提交失败（"+e+")",o.resultMsg=e,n.failData.push(o)})).finally((function(){e+=1,e<a?n.submitFun(t,e,a):(n.$refs.uploadLoad.closeModel(),n.$refs.resultModel.showModel())}))}},LeftQty1Seve:function(){this.multipleSelection.forEach((function(t,e){"未提交"===t.status&&(t.LeftQty1=t.LeftQty2+"")}))},setNewData:function(t,e,a){var n=t[e],o=Object(i["a"])(this.data);o.forEach((function(t,e){n.AppNo==t.AppNo&&(n.LeftQty1,n.LeftQty=n.LeftQty-a)})),this.tableData=o,localStorage.setItem("selectData",JSON.stringify(o))},onCellChange:function(t,e,a){var n=Object(i["a"])(this.tableData),o=n.find((function(e){return e===t}));o&&(o[e]=a,this.tableData=n)},justValue:function(t,e){var a=Object(i["a"])(this.tableData),n=t.LeftQty,o=t.ExQty,r=n-o;e>r&&(this.$message.info("可归还数量为"+r),a.forEach((function(e,a){e===t&&(e.LeftQty1=r)})),this.tableData=a)},deleteData:function(){var t=this.tableData;this.multipleSelection.forEach((function(e){console.log(e),t.forEach((function(a,n){a==e&&t.splice(n--,1)}))})),localStorage.setItem("selectData",JSON.stringify(t))},deleteSingle:function(t){var e=this.tableData;e.forEach((function(a,n){a==t&&e.splice(n--,1)})),localStorage.setItem("selectData",JSON.stringify(e))},exportConfirm:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.multipleSelection=[],e.next=3,t.checkImportData(t.importData);case 3:t.tableData=e.sent,t.tableData.length>0?(a=[],t.tableData.forEach((function(e,n){a.push(t.getContractData(e,n))})),Promise.all(a).finally((function(){localStorage.setItem("selectData",JSON.stringify(t.tableData)),t.$refs.exportConfirm.closeModel()}))):(t.$refs.exportConfirm.closeModel(),localStorage.setItem("selectData",JSON.stringify(t.tableData)));case 5:case"end":return e.stop()}}),e)})))()},checkImportData:function(){var t=this.importData,e={CompactNo:"合约编号不能为空",StockCode:"证券号码不能为空",LeftQty1:"归还数量不能为空"};return t.forEach((function(t){for(var a in e){var n=t[a];d["a"].checkNull(n)&&(t.status="导入失败（数据不符合规范）")}})),t},checkNull:function(t){return 0==t||""!=t&&null!=t&&void 0!=t},importExcel:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,o,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.raw,n&&"uploading"!=t.status){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,f["a"].uploadXlsx(n);case 5:return o=a.sent,r=b.a.read(o,{type:"binary"}),o=b.a.utils.sheet_to_json(r.Sheets[r.SheetNames[0]]),a.next=10,e.initData(o);case 10:if(i=a.sent,0!==i.length){a.next=14;break}return e.$message({message:"导入数据为空，请检查文件",type:"warning"}),a.abrupt("return");case 14:e.importData=i,e.$refs.exportConfirm.showModel();case 16:case"end":return a.stop()}}),a)})))()},initData:function(t){console.log(t);var e=[];for(var a in t){for(var n in e[a]={},t[a])-1!=n.indexOf("合约编号")&&(e[a].CompactNo=t[a][n]),-1!=n.indexOf("证券代码")&&(e[a].StockCode=t[a][n]),-1!=n.indexOf("归还数量")&&(e[a].LeftQty1=t[a][n]);e[a].status="未提交"}return e},getContractData:function(t,e){var a=this;if("未提交"===t.status){var n={RouteID:"W",OperatorID:this.fundAccount,FundAccount:this.fundAccount,CompactStatus:"0",QueryMode:"A",CompactNo:t.CompactNo};Object(v["a"])(n,110).then((function(n){var o=n.data;o.length>0?(o[0].StockCode=t.StockCode,o[0].LeftQty1=t.LeftQty1,o[0].LeftQty2=o[0].LeftQty-o[0].ExQty,o[0].status="未提交",a.tableData[e]=o[0],a.$set(a.tableData,e,o[0])):(t.status="导入失败（未查到该合同）",a.$set(a.tableData,e,t))})).catch((function(e){var n=e.errorMessage||e.message;-1!=n.indexOf("timeout")?t.status="导入失败（接口调用超时)":t.status="导入失败（"+n+")",a.importFailData.push(t)}))}},deleteSuccData:function(){var t=this.tableData;this.successData.forEach((function(e){t.forEach((function(a,n){a==e&&t.splice(n--,1)}))})),localStorage.setItem("selectData",JSON.stringify(t))},exportData:function(){var t=this;if(this.exportLoading=!0,0==this.tableData.length)return this.$message({message:"暂无可导出数据！",type:"warning"}),void(this.exportLoading=!1);this.$nextTick((function(){d["a"].exportDataMethod("#tableExport","归还"),t.exportLoading=!1}))}}},w=D,_=(a("7ace"),a("2877")),x=Object(_["a"])(w,n,o,!1,null,"5ca7c045",null);e["default"]=x.exports},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var n=a("6b75");function o(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var i=a("06c5");a("d9e2");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return o(t)||r(t)||Object(i["a"])(t)||l()}},4398:function(t,e,a){},"4df4":function(t,e,a){"use strict";var n=a("da84"),o=a("0366"),r=a("c65b"),i=a("7b0b"),l=a("9bdd"),c=a("e95a"),s=a("68ee"),u=a("07fa"),f=a("8418"),d=a("9a1f"),p=a("35a1"),b=n.Array;t.exports=function(t){var e=i(t),a=s(this),n=arguments.length,h=n>1?arguments[1]:void 0,m=void 0!==h;m&&(h=o(h,n>2?arguments[2]:void 0));var y,g,v,S,D,w,_=p(e),x=0;if(!_||this==b&&c(_))for(y=u(e),g=a?new this(y):b(y);y>x;x++)w=m?h(e[x],x):e[x],f(g,x,w);else for(S=d(e,_),D=S.next,g=a?new this:[];!(v=r(D,S)).done;x++)w=m?l(S,h,[v.value,x],!0):v.value,f(g,x,w);return g.length=x,g}},"6b75":function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},"7ace":function(t,e,a){"use strict";a("4398")},"9bdd":function(t,e,a){var n=a("825a"),o=a("2a62");t.exports=function(t,e,a,r){try{return r?e(n(a)[0],a[1]):e(a)}catch(i){o(t,"throw",i)}}},a630:function(t,e,a){var n=a("23e7"),o=a("4df4"),r=a("1c7e"),i=!r((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:i},{from:o})},b0c0:function(t,e,a){var n=a("83ab"),o=a("5e77").EXISTS,r=a("e330"),i=a("9bf2").f,l=Function.prototype,c=r(l.toString),s=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=r(s.exec),f="name";n&&!o&&i(l,f,{configurable:!0,get:function(){try{return u(s,c(this))[1]}catch(t){return""}}})},d28b:function(t,e,a){var n=a("746f");n("iterator")},e01a:function(t,e,a){"use strict";var n=a("23e7"),o=a("83ab"),r=a("da84"),i=a("e330"),l=a("1a2d"),c=a("1626"),s=a("3a9b"),u=a("577e"),f=a("9bf2").f,d=a("e893"),p=r.Symbol,b=p&&p.prototype;if(o&&c(p)&&(!("description"in b)||void 0!==p().description)){var h={},m=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),e=s(b,this)?new p(t):void 0===t?p():p(t);return""===t&&(h[e]=!0),e};d(m,p),m.prototype=b,b.constructor=m;var y="Symbol(test)"==String(p("test")),g=i(b.toString),v=i(b.valueOf),S=/^Symbol\((.*)\)[^)]+$/,D=i("".replace),w=i("".slice);f(b,"description",{configurable:!0,get:function(){var t=v(this),e=g(t);if(l(h,t))return"";var a=y?w(e,7,-1):D(e,S,"$1");return""===a?void 0:a}}),n({global:!0,forced:!0},{Symbol:m})}},fb6a:function(t,e,a){"use strict";var n=a("23e7"),o=a("da84"),r=a("e8b5"),i=a("68ee"),l=a("861d"),c=a("23cb"),s=a("07fa"),u=a("fc6a"),f=a("8418"),d=a("b622"),p=a("1dde"),b=a("f36a"),h=p("slice"),m=d("species"),y=o.Array,g=Math.max;n({target:"Array",proto:!0,forced:!h},{slice:function(t,e){var a,n,o,d=u(this),p=s(d),h=c(t,p),v=c(void 0===e?p:e,p);if(r(d)&&(a=d.constructor,i(a)&&(a===y||r(a.prototype))?a=void 0:l(a)&&(a=a[m],null===a&&(a=void 0)),a===y||void 0===a))return b(d,h,v);for(n=new(void 0===a?y:a)(g(v-h,0)),o=0;h<v;h++,o++)h in d&&f(n,o,d[h]);return n.length=o,n}})}}]);